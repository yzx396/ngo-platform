# Internationalization (i18n)

This document details the internationalization (i18n) system for the Lead Forward Platform.

## Overview

The platform supports multiple languages with **Simplified Chinese (zh-CN) as the default** and **English as fallback**. The implementation uses `react-i18next` for flexible, type-safe translations.

## Configuration

- **Framework**: `i18next` with `react-i18next` hooks
- **Language detection**: Browser language preference → localStorage → HTML lang attribute
- **Default language**: Simplified Chinese (zh-CN)
- **Fallback language**: English (en)
- **Translation files**: JSON files in `src/react-app/i18n/locales/`

### File Structure

```
src/react-app/i18n/
├── index.ts                              # i18n configuration and initialization
├── locales/
│   ├── zh-CN/
│   │   └── translation.json             # Simplified Chinese translations
│   └── en/
│       └── translation.json             # English translations
```

**Configuration:** `src/react-app/i18n/index.ts` - initializes i18next with language detection and fallback.

## Using Translations in Components

```typescript
import { useTranslation } from 'react-i18next';

export function MyComponent() {
  const { t } = useTranslation();

  return (
    <div>
      <h1>{t('common.appName')}</h1>
      <p>{t('home.subtitle')}</p>
      {/* With interpolation */}
      <p>{t('common.signedInAs', { name: user.name })}</p>
    </div>
  );
}
```

## Translation Key Organization

Translations are organized by feature in the JSON namespace:

- **common**: Generic UI elements (buttons, labels, navigation)
- **home**: Home page content and features
- **auth**: Authentication-related strings (login, OAuth)
- **mentor**: Mentor profile and browsing related
- **mentoringLevel**: Mentoring level enum values
- **paymentType**: Payment method enum values
- **matches**: Match/mentorship request related
- **status**: Status labels (pending, accepted, etc.)
- **errors**: Error messages and error states
- **pagination**: Pagination controls
- **language**: Language selector

## Adding New Translations

When adding a new feature with user-facing text:

### 1. Create translation keys in both language files

**src/react-app/i18n/locales/zh-CN/translation.json:**
```json
{
  "myFeature": {
    "title": "功能标题",
    "description": "功能描述",
    "button": "点击我"
  }
}
```

**src/react-app/i18n/locales/en/translation.json:**
```json
{
  "myFeature": {
    "title": "Feature Title",
    "description": "Feature description",
    "button": "Click me"
  }
}
```

### 2. Use the keys in components

```typescript
const { t } = useTranslation();
return <h1>{t('myFeature.title')}</h1>;
```

### 3. Keep both files in sync

Always update both language files when adding or changing translations. Missing keys fall back to the key name itself, making untranslated content obvious.

## Language Switcher

**LanguageSwitcher** component in navbar allows users to switch languages. User preference is saved to localStorage and persists across sessions.

## Testing with i18n

Tests use English by default (configured in `vitest.setup.ts`).

### Example test:

```typescript
import { render, screen } from '@testing-library/react';
import { MyComponent } from './MyComponent';

describe('MyComponent', () => {
  it('should render translated text', () => {
    render(<MyComponent />);
    expect(screen.getByText(/feature title/i)).toBeInTheDocument();
  });
});
```

Use actual translated English text in tests (not i18n keys).

## Common Patterns

### Date/Time Formatting

Use `i18next-browser-languagedetector` to detect locale, then format dates according to user's language:

```typescript
const date = new Date();
const formatter = new Intl.DateTimeFormat(i18n.language);
const formatted = formatter.format(date);
```

### Numbers and Currency

Similar approach with `Intl.NumberFormat`:

```typescript
const formatter = new Intl.NumberFormat(i18n.language, {
  style: 'currency',
  currency: 'USD'
});
const formatted = formatter.format(1000.50);
```

### Pluralization

Use i18next's plural suffixes:

```json
{
  "items_one": "1 item",
  "items_other": "{{count}} items"
}
```

Then use:
```typescript
t('items', { count: 5 }) // Returns "5 items"
```

## Best Practices

1. **Keep keys organized** by feature namespace
2. **Use interpolation** for dynamic content: `t('key', { variable: value })`
3. **Avoid HTML in translations** - use React components instead
4. **Keep translations simple** - avoid complex formatting in JSON
5. **Test both languages** - catch missing or broken keys
6. **Use consistent terminology** - create a glossary for common terms across both languages

## Troubleshooting

**Component showing untranslated key instead of text:**
- Check that key exists in both `translation.json` files
- Verify key path matches exactly (e.g., `common.appName` not `appName`)
- Check browser console for i18next warnings

**Language not switching:**
- Verify LanguageSwitcher component is rendered
- Check localStorage for `i18nextLng` key
- Check that both translation files are properly loaded

**Missing translations affecting production:**
- Verify both language files are built into `dist/`
- Check that fallback language (English) has all keys
- Run build: `npm run build` to catch missing translations
